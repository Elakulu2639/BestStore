@model Product
@{
    var recommendations = ViewData["Recommendations"] as List<Product>;
}


<div class="row">
    <div class="col-md-4 text-center">
        <img src="/products/@Model.ImageFileName" class="img-fluid mb-3" alt="..." width="250" />
    </div>
    <div class="col-md-8">
        <h3 class="mb-3">@Model.Name</h3>
        <h3 class="mb-3">@(Model.Price)$</h3>
        <button type="button" class="btn btn-warning btn-sm" onclick="addToCart(this, @Model.Id)">
            Add to Cart <i class="bi bi-cart4"></i>
        </button>

        <hr />

        <div class="row mb-3">
            <div class="col-sm-3 fw-bold">
                Brand
            </div>
            <div class="col-sm-9">
                @Model.Brand
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-sm-3 fw-bold">
                Category
            </div>
            <div class="col-sm-9">
                @Model.Category
            </div>
        </div>


        <div class="fw-bold">Description</div>
        <div style="white-space: pre-line">@Model.Description</div>
    </div>
</div>


@if (User.Identity.IsAuthenticated)
{
    @if (recommendations?.Any() == true)
    {
        <div class="mt-5">
            <h3>Frequently Bought Together</h3>
            <div class="row g-3">
                @foreach (var product in recommendations)
                {
                    <div class="col-md-3">
                        <div class="card h-100">
                            <img src="/products/@product.ImageFileName"
                                 class="card-img-top"
                                 alt="@product.Name"
                                 style="height: 200px; object-fit: contain">
                            <div class="card-body">
                                <h5 class="card-title">@product.Name</h5>
                                <p class="card-text">@product.Price.ToString("C")</p>
                                <a asp-controller="Store"
                                   asp-action="Details"
                                   asp-route-id="@product.Id"
                                   class="btn btn-primary btn-sm">
                                    View Details
                                </a>
                                <button type="button" class="btn btn-warning btn-sm" onclick="addToCart(this, @Model.Id)">
                                    Add to Cart <i class="bi bi-cart4"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    }
    else
    {
        <div class="mt-5">
            <p class="text-muted">No personalized recommendations available yet. Continue shopping to see suggestions!</p>
        </div>
    }
}
else
{
    <div class="mt-5">
        <p class="text-muted">
            <a asp-controller="Account" asp-action="Login">Sign in</a> to see personalized recommendations
        </p>
    </div>
}                                                                                                                   